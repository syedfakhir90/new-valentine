<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Flappy Valentine ğŸ’–</title>

<style>
*{
  box-sizing:border-box;
  -webkit-tap-highlight-color: transparent;
}

body{
  margin:0;
  font-family:'Comic Sans MS', cursive;
  background: linear-gradient(135deg,#ff9a9e,#fad0c4);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.container{
  background:#fff0f6;
  padding:15px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 0 25px rgba(255,105,180,0.6);
  width:95%;
  max-width:420px;
}

h2{color:#ff4f81;}

input{
  padding:12px;
  margin:6px 0;
  border-radius:10px;
  border:1px solid #ffb6c1;
  width:100%;
  font-size:16px;
}

button{
  padding:14px 25px;
  background:#ff4f81;
  color:white;
  border:none;
  border-radius:25px;
  font-size:16px;
  margin:8px;
  width:100%;
}

canvas{
  background:#ffe4ec;
  border-radius:15px;
  display:none;
  width:100%;
  height:auto;
  touch-action: manipulation;
}

#score{
  color:#ff2e6c;
  font-size:18px;
}

.progress{
  width:100%;
  background:#ffd6e4;
  border-radius:20px;
  overflow:hidden;
  margin:6px 0;
}

.progress-bar{
  height:15px;
  width:0%;
  background:#ff4f81;
}

#message{
  color:#ff1f6d;
  font-size:16px;
}

#winScreen{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(255,182,193,0.95);
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:20px;
}

.choice-btn{
  font-size:20px;
  padding:15px 40px;
  width:80%;
  max-width:300px;
}

.no{background:#aaa;}

#popup{
  display:none;
  background:white;
  padding:25px;
  border-radius:20px;
  margin-top:20px;
}

.hug{
  font-size:60px;
  animation:hug 1s infinite alternate;
}

@keyframes hug{
  from{transform:scale(1);}
  to{transform:scale(1.2);}
}

.heart{
  position:absolute;
  font-size:22px;
  animation:float 2s linear infinite;
}

@keyframes float{
  from{transform:translateY(0);opacity:1;}
  to{transform:translateY(-200px);opacity:0;}
}
</style>
</head>

<body>

<div class="container" id="startScreen">
  <h2>ğŸ¦ğŸ’– Flappy Valentine ğŸ’–</h2>
  <input id="playerName" placeholder="Your Name">
  <input id="valentineName" placeholder="Valentine Name">
  <button onclick="startGame()">Start Game ğŸ’—</button>
  <p>Tap / Click to Fly ğŸ’•</p>
</div>

<div class="container">
  <div id="score"></div>
  <div class="progress"><div class="progress-bar" id="bar"></div></div>
  <div id="message"></div>
  <canvas id="game"></canvas>
</div>

<div id="winScreen">
  <h1 id="winText"></h1>
  <h2>ğŸ’ Will you be my Valentine? ğŸ’</h2>
  <button class="choice-btn" onclick="answerYes()">YES ğŸ’–</button>
  <button class="choice-btn no" onclick="answerNo()">NO ğŸ™ˆ</button>
  <div id="popup">
    <div class="hug">ğŸ«‚</div>
    <p id="loveMsg"></p>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resizeCanvas(){
  const w = Math.min(360, window.innerWidth * 0.9);
  canvas.width = w;
  canvas.height = w * (4/3);
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let birdY=200, birdV=0;
let pipes=[], score=0;
let player,valentine;
const gravity=0.5, lift=-8;

function startGame(){
  player=document.getElementById("playerName").value||"Someone";
  valentine=document.getElementById("valentineName").value||"My Love";
  document.getElementById("startScreen").style.display="none";
  canvas.style.display="block";
  reset();
  requestAnimationFrame(loop);
}

function reset(){
  birdY=canvas.height/2;
  birdV=0;
  pipes=[];
  score=0;
}

function flap(){ birdV = lift; }

document.addEventListener("click", flap);
document.addEventListener("touchstart", e=>{
  e.preventDefault();
  flap();
},{passive:false});

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  birdV+=gravity;
  birdY+=birdV;

  ctx.fillStyle="#ff4f81";
  ctx.beginPath();
  ctx.arc(80,birdY,12,0,Math.PI*2);
  ctx.fill();

  if(pipes.length===0 || pipes[pipes.length-1].x < canvas.width-160){
    let gap=120;
    let top=Math.random()*200+40;
    pipes.push({x:canvas.width, top, gap, passed:false});
  }

  pipes.forEach(p=>{
    p.x-=2;
    ctx.fillStyle="#ff1f6d";
    ctx.fillRect(p.x,0,40,p.top);
    ctx.fillRect(p.x,p.top+p.gap,40,canvas.height);

    if(!p.passed && p.x<80){
      p.passed=true;
      score+=10;
    }

    if(p.x<92 && p.x+40>68){
      if(birdY<p.top || birdY>p.top+p.gap){
        reset();
      }
    }
  });

  pipes=pipes.filter(p=>p.x>-50);

  let percent=Math.min(score,100);
  document.getElementById("score").innerText=
    `ğŸ’˜ Will you be my Valentine: ${percent}%`;
  document.getElementById("bar").style.width=percent+"%";

  document.getElementById("message").innerText=
    percent<30?"ğŸ’— Just startingâ€¦":
    percent<60?"ğŸ’“ Iâ€™m falling for youâ€¦":
    percent<90?"ğŸ˜ Almost thereâ€¦":
    "ğŸ’– Forever us!";

  if(percent>=100){ win(); return; }

  if(birdY<0 || birdY>canvas.height) reset();

  requestAnimationFrame(loop);
}

function win(){
  document.getElementById("winScreen").style.display="flex";
  document.getElementById("winText").innerText=`${player} â¤ï¸ ${valentine}`;
}

function answerYes(){
  document.getElementById("popup").style.display="block";
  document.getElementById("loveMsg").innerText=
    `I love you ${valentine} ğŸ’– Thank you for being my Valentine ğŸ’`;
}

function answerNo(){
  alert("ğŸ¥º My heart will still wait for youâ€¦");
}
</script>

</body>
</html>